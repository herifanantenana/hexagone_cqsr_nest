[{"kind":1,"language":"markdown","value":"# Full User Journey — End-to-End Integration\n\nComplete user journey simulating a real user interacting with the API:\n\n1. **Health Check** — Verify API is up\n2. **Signup** — Create account\n3. **Login** — Authenticate\n4. **Profile** — View & update profile\n5. **Posts** — Create, list, read, update posts\n6. **Second User** — Test cross-user visibility\n7. **Cleanup** — Delete posts & logout\n\n**Base URL:** `http://localhost:3000`\n\n> Run all cells sequentially from top to bottom.","outputs":[]},{"kind":1,"language":"markdown","value":"---\n# Phase 1: Server Health","outputs":[]},{"kind":2,"language":"rest-book","value":"GET http://localhost:3000/health","outputs":[]},{"kind":1,"language":"markdown","value":"---\n# Phase 2: User Registration","outputs":[]},{"kind":1,"language":"markdown","value":"### Register User A (main user)","outputs":[]},{"kind":2,"language":"rest-book","value":"let userA = POST http://localhost:3000/auth/signup\nContent-Type: application/json\n\n{\n    \"email\": \"journey-userA@example.com\",\n    \"password\": \"SecureP@ss1!\",\n    \"displayName\": \"Journey User A\"\n}","outputs":[]},{"kind":1,"language":"markdown","value":"### Register User B (secondary user for cross-user tests)","outputs":[]},{"kind":2,"language":"rest-book","value":"let userB = POST http://localhost:3000/auth/signup\nContent-Type: application/json\n\n{\n    \"email\": \"journey-userB@example.com\",\n    \"password\": \"SecureP@ss2!\",\n    \"displayName\": \"Journey User B\"\n}","outputs":[]},{"kind":1,"language":"markdown","value":"---\n# Phase 3: Authentication","outputs":[]},{"kind":1,"language":"markdown","value":"### Login as User A","outputs":[]},{"kind":2,"language":"rest-book","value":"let authA = POST http://localhost:3000/auth/login\nContent-Type: application/json\n\n{\n    \"email\": \"journey-userA@example.com\",\n    \"password\": \"SecureP@ss1!\"\n}","outputs":[]},{"kind":1,"language":"markdown","value":"### Login as User B","outputs":[]},{"kind":2,"language":"rest-book","value":"let authB = POST http://localhost:3000/auth/login\nContent-Type: application/json\n\n{\n    \"email\": \"journey-userB@example.com\",\n    \"password\": \"SecureP@ss2!\"\n}","outputs":[]},{"kind":1,"language":"markdown","value":"---\n# Phase 4: User Profile Management","outputs":[]},{"kind":1,"language":"markdown","value":"### User A — View my profile","outputs":[]},{"kind":2,"language":"rest-book","value":"let profileA = GET http://localhost:3000/users/me\nAuthorization: Bearer $authA.data.accessToken","outputs":[]},{"kind":1,"language":"markdown","value":"### User A — Update profile","outputs":[]},{"kind":2,"language":"rest-book","value":"PUT http://localhost:3000/users/me\nContent-Type: application/json\nAuthorization: Bearer $authA.data.accessToken\n\n{\n    \"displayName\": \"Alice A. (Updated)\",\n    \"bio\": \"Full-stack developer | NestJS enthusiast | Clean Architecture advocate\"\n}","outputs":[]},{"kind":1,"language":"markdown","value":"### User B — View User A's public profile","outputs":[]},{"kind":2,"language":"rest-book","value":"GET http://localhost:3000/users/$profileA.data.id","outputs":[]},{"kind":1,"language":"markdown","value":"---\n# Phase 5: Posts — User A creates content","outputs":[]},{"kind":1,"language":"markdown","value":"### User A — Create a public post","outputs":[]},{"kind":2,"language":"rest-book","value":"let postPublicA = POST http://localhost:3000/posts\nContent-Type: application/json\nAuthorization: Bearer $authA.data.accessToken\n\n{\n    \"title\": \"Getting Started with Hexagonal Architecture\",\n    \"content\": \"Hexagonal architecture (ports & adapters) helps decouple your business logic from infrastructure. Here is how I applied it to this NestJS project...\",\n    \"visibility\": \"public\"\n}","outputs":[]},{"kind":1,"language":"markdown","value":"### User A — Create a private post","outputs":[]},{"kind":2,"language":"rest-book","value":"let postPrivateA = POST http://localhost:3000/posts\nContent-Type: application/json\nAuthorization: Bearer $authA.data.accessToken\n\n{\n    \"title\": \"Private Notes: CQRS Implementation\",\n    \"content\": \"TODO: Refactor the command handlers to use event sourcing. This is a draft — not ready for public.\",\n    \"visibility\": \"private\"\n}","outputs":[]},{"kind":1,"language":"markdown","value":"---\n# Phase 6: Posts — User B creates content","outputs":[]},{"kind":1,"language":"markdown","value":"### User B — Create a public post","outputs":[]},{"kind":2,"language":"rest-book","value":"let postPublicB = POST http://localhost:3000/posts\nContent-Type: application/json\nAuthorization: Bearer $authB.data.accessToken\n\n{\n    \"title\": \"Why I Love Domain-Driven Design\",\n    \"content\": \"DDD changed how I think about software. Bounded contexts, aggregates, and value objects bring clarity to complex domain logic.\",\n    \"visibility\": \"public\"\n}","outputs":[]},{"kind":1,"language":"markdown","value":"---\n# Phase 7: Cross-user visibility tests","outputs":[]},{"kind":1,"language":"markdown","value":"### List all public posts (anyone can see)\n\nBoth User A and User B's public posts should appear. Private posts should NOT.","outputs":[]},{"kind":2,"language":"rest-book","value":"GET http://localhost:3000/posts\n    ?page=1\n    &pageSize=50","outputs":[]},{"kind":1,"language":"markdown","value":"### Anonymous — Read User A's public post (OK)","outputs":[]},{"kind":2,"language":"rest-book","value":"GET http://localhost:3000/posts/$postPublicA.data.id","outputs":[]},{"kind":1,"language":"markdown","value":"### User B — Try to read User A's private post (expect 403)\n\nUser B is not the owner, so access should be forbidden.","outputs":[]},{"kind":2,"language":"rest-book","value":"GET http://localhost:3000/posts/$postPrivateA.data.id\nAuthorization: Bearer $authB.data.accessToken","outputs":[]},{"kind":1,"language":"markdown","value":"### User A — Read own private post (OK)\n\nThe owner can always read their own posts.","outputs":[]},{"kind":2,"language":"rest-book","value":"GET http://localhost:3000/posts/$postPrivateA.data.id\nAuthorization: Bearer $authA.data.accessToken","outputs":[]},{"kind":1,"language":"markdown","value":"### User B — Try to update User A's post (expect 403)\n\nOnly the owner can update their posts.","outputs":[]},{"kind":2,"language":"rest-book","value":"PATCH http://localhost:3000/posts/$postPublicA.data.id\nContent-Type: application/json\nAuthorization: Bearer $authB.data.accessToken\n\n{\n    \"title\": \"Hacked Title\"\n}","outputs":[]},{"kind":1,"language":"markdown","value":"### User B — Try to delete User A's post (expect 403)\n\nOnly the owner can delete their posts.","outputs":[]},{"kind":2,"language":"rest-book","value":"DELETE http://localhost:3000/posts/$postPublicA.data.id\nAuthorization: Bearer $authB.data.accessToken","outputs":[]},{"kind":1,"language":"markdown","value":"---\n# Phase 8: Post Updates","outputs":[]},{"kind":1,"language":"markdown","value":"### User A — Update public post","outputs":[]},{"kind":2,"language":"rest-book","value":"PATCH http://localhost:3000/posts/$postPublicA.data.id\nContent-Type: application/json\nAuthorization: Bearer $authA.data.accessToken\n\n{\n    \"title\": \"Getting Started with Hexagonal Architecture (Revised)\",\n    \"content\": \"Updated: Hexagonal architecture (ports & adapters) helps decouple your business logic from infrastructure. Added real-world examples from this NestJS CQRS project.\"\n}","outputs":[]},{"kind":1,"language":"markdown","value":"### User A — Make private post public","outputs":[]},{"kind":2,"language":"rest-book","value":"PATCH http://localhost:3000/posts/$postPrivateA.data.id\nContent-Type: application/json\nAuthorization: Bearer $authA.data.accessToken\n\n{\n    \"visibility\": \"public\"\n}","outputs":[]},{"kind":1,"language":"markdown","value":"### Verify: previously private post is now publicly accessible","outputs":[]},{"kind":2,"language":"rest-book","value":"GET http://localhost:3000/posts/$postPrivateA.data.id","outputs":[]},{"kind":1,"language":"markdown","value":"---\n# Phase 9: Token Refresh","outputs":[]},{"kind":1,"language":"markdown","value":"### User A — Refresh access token","outputs":[]},{"kind":2,"language":"rest-book","value":"let refreshedA = POST http://localhost:3000/auth/refresh\nContent-Type: application/json\n\n{\n    \"refreshToken\": \"$authA.data.refreshToken\"\n}","outputs":[]},{"kind":1,"language":"markdown","value":"### Use refreshed token to access profile","outputs":[]},{"kind":2,"language":"rest-book","value":"GET http://localhost:3000/users/me\nAuthorization: Bearer $refreshedA.data.accessToken","outputs":[]},{"kind":1,"language":"markdown","value":"---\n# Phase 10: Cleanup & Logout","outputs":[]},{"kind":1,"language":"markdown","value":"### User A — Delete posts","outputs":[]},{"kind":2,"language":"rest-book","value":"DELETE http://localhost:3000/posts/$postPublicA.data.id\nAuthorization: Bearer $refreshedA.data.accessToken","outputs":[]},{"kind":2,"language":"rest-book","value":"DELETE http://localhost:3000/posts/$postPrivateA.data.id\nAuthorization: Bearer $refreshedA.data.accessToken","outputs":[]},{"kind":1,"language":"markdown","value":"### User B — Delete post","outputs":[]},{"kind":2,"language":"rest-book","value":"DELETE http://localhost:3000/posts/$postPublicB.data.id\nAuthorization: Bearer $authB.data.accessToken","outputs":[]},{"kind":1,"language":"markdown","value":"### Verify: posts list is empty (or reduced)","outputs":[]},{"kind":2,"language":"rest-book","value":"GET http://localhost:3000/posts","outputs":[]},{"kind":1,"language":"markdown","value":"### User A — Logout","outputs":[]},{"kind":2,"language":"rest-book","value":"POST http://localhost:3000/auth/logout\nAuthorization: Bearer $refreshedA.data.accessToken","outputs":[]},{"kind":1,"language":"markdown","value":"### User B — Logout","outputs":[]},{"kind":2,"language":"rest-book","value":"POST http://localhost:3000/auth/logout\nAuthorization: Bearer $authB.data.accessToken","outputs":[]},{"kind":1,"language":"markdown","value":"---\n# Done!\n\nAll major user flows have been tested end-to-end:\n\n- Health check\n- User registration (signup)\n- Authentication (login, refresh, logout)\n- Profile management (view, update)\n- Posts CRUD (create, read, update, delete)\n- Cross-user access control (public/private visibility, ownership enforcement)\n- Token lifecycle (refresh, revocation on logout)","outputs":[]}]