# ─── Base de données PostgreSQL ────────────────────────────────────────────────
# Format : postgresql://user:password@host:port/dbname
DATABASE_URL=postgresql://arakotom:herifanantenana@localhost:5432/test_arch

# ─── JWT ──────────────────────────────────────────────────────────────────────
# Clé secrète pour signer les access tokens (CHANGER EN PRODUCTION)
JWT_ACCESS_SECRET=your-super-secret-access-key-change-in-production
# Durée de vie de l'access token en secondes (900 = 15 minutes)
JWT_ACCESS_TTL_SECONDS=900
# Durée de vie du refresh token en jours
REFRESH_TTL_DAYS=7
# Tolérance d'horloge en secondes (compense le décalage client/serveur)
CLOCK_SKEW_SECONDS=5

# ─── Application ──────────────────────────────────────────────────────────────
PORT=3000
NODE_ENV=production
# Activer si derrière un reverse proxy (Nginx, Cloudflare) pour résoudre l'IP réelle
TRUST_PROXY=false

# ─── Redis (stockage partagé des compteurs de rate limiting) ──────────────────
# ioredis supporte redis:// et rediss:// (TLS pour Upstash, ElastiCache, etc.)
REDIS_URL="rediss://default:AXZDAAIncDIyOWJhOGFiZTNiYmM0ZThkOGYzZDQ2YmU0YTI3MGNkZnAyMzAyNzU@live-weasel-30275.upstash.io:6379"

# ─── Rate Limiting (compteurs partagés via Redis) ─────────────────────────────
# Global : toutes les routes (120 req / 60s par défaut)
THROTTLE_GLOBAL_TTL_MS=60000
THROTTLE_GLOBAL_LIMIT=120
# Auth : login, signup, refresh (5 req / 60s — protection brute force)
THROTTLE_AUTH_TTL_MS=60000
THROTTLE_AUTH_LIMIT=5
# Upload : avatar upload (10 req / 60s — évite le spam de fichiers)
THROTTLE_UPLOAD_TTL_MS=60000
THROTTLE_UPLOAD_LIMIT=10


# Logging (Winston)
LOG_LEVEL=http                  # error, warn, info, http, debug
LOG_DIR=logs                    # Dossier de destination des fichiers de log
LOG_CONSOLE=true                # Logs console (format lisible, coloré)
LOG_FILE=true                   # Persistence en fichiers
LOG_HTTP=true                   # Logs HTTP (requêtes entrantes/sortantes)
LOG_JSON_FILES=false            # Texte brut en dev (plus lisible), JSON en prod
LOG_ROTATE=false                # Pas de rotation en dev
LOG_MAX_FILES=14d               # Durée de rétention (ex: "14d" ou "30")